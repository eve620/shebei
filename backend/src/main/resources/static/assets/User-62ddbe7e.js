import{_ as j,g as i,o as H,h as r,b,c as k,i as a,j as s,w as C,k as N,d as A,F as M,m as p,s as S,z as T}from"./index-f765dbbe.js";import{g as $}from"./Instance-3897144e.js";import{O as G,d as K,D as Q}from"./exportToExcel-5a33b8a7.js";const W={class:"loading"},X={key:0},Y=["onClick"],Z={__name:"User",setup(ee){const d=$();let g;const l=i({}),U=i(!1),f=i(!1),y=()=>{l.value={},f.value=!0},F=t=>{n.value=!1,d.getUserList(t).then(e=>{v.value=e.data.data,n.value=!0})},c=i(),O=()=>{c.value.validateFields().then(t=>{n.value=!1,d.addUser(l.value).then(e=>{e.data.code===1?(p.info(e.data.data),d.getUserList().then(u=>{v.value=u.data.data,n.value=!0})):(p.info(e.data.msg),n.value=!0)}),f.value=!1}).catch(t=>{console.log("Validate Failed:",t)})},E=()=>{c.value.resetFields(),f.value=!1},_=i(!1),B=t=>{l.value=JSON.parse(JSON.stringify(t)),_.value=!0},V=()=>{c.value.validateFields().then(t=>{n.value=!1,d.editUser(l.value).then(e=>{e.data.code===1?(p.info(e.data.data),d.getUserList().then(u=>{v.value=u.data.data,n.value=!0})):(p.info(e.data.msg),n.value=!0)}),_.value=!1}).catch(t=>{console.log("Validate Failed:",t)})},q=()=>{c.value.resetFields(),_.value=!1},D=t=>{n.value=!1,d.deleteUserById(t).then(e=>{e.data.code===1?(p.info(e.data.data),d.getUserList().then(u=>{v.value=u.data.data,n.value=!0})):p.info(e.data.msg)})};H(()=>{d.whoami().then(t=>{t.data.code===1&&(g=t.data.data,U.value=g.roleId)}),d.getUserList().then(t=>{v.value=t.data.data,n.value=!0})});const L=()=>{K("/user",v.value,"教师表.xlsx")},v=i(),n=i(!1),R=[{title:"工资号",dataIndex:"userAccount",width:"15%"},{title:"姓名",dataIndex:"userName",width:"15%"},{title:"权限",dataIndex:"roleId",width:"40%",customRender(t){return t.value===1?"管理员":"教师"}},{title:"操作",dataIndex:"operation"}];return(t,e)=>{const u=r("a-input"),m=r("a-form-item"),w=r("a-form"),h=r("a-modal"),P=r("a-spin"),x=r("a-radio-button"),z=r("a-radio-group"),J=r("a-table");return b(),k(M,null,[a(h,{open:f.value,"onUpdate:open":e[3]||(e[3]=o=>f.value=o),"ok-text":"确定","cancel-text":"取消",onOk:O,onCancel:E,title:"添加"},{default:s(()=>[a(w,{ref_key:"formRef",ref:c,model:l.value,labelCol:{span:6},wrapperCol:{span:14}},{default:s(()=>[a(m,{name:"userAccount",label:"工资号",rules:[{required:!0,message:"请输入工资号"}]},{default:s(()=>[a(u,{value:l.value.userAccount,"onUpdate:value":e[0]||(e[0]=o=>l.value.userAccount=o),placeholder:"请输入工资号"},null,8,["value"])]),_:1}),a(m,{name:"userName",label:"姓名",rules:[{required:!0,message:"请输入姓名"}]},{default:s(()=>[a(u,{value:l.value.userName,"onUpdate:value":e[1]||(e[1]=o=>l.value.userName=o),placeholder:"请输入姓名"},null,8,["value"])]),_:1}),a(m,{name:"userPassword",label:"密码",rules:[{required:!0,message:"密码最低6位",min:6}]},{default:s(()=>[a(u,{value:l.value.userPassword,"onUpdate:value":e[2]||(e[2]=o=>l.value.userPassword=o),placeHolder:"请输入密码"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),a(G,{addShow:U.value,onAdd:y,onExport:L,onSearch:F},null,8,["addShow"]),C(A("div",W,[a(P,{size:"large"})],512),[[N,!n.value]]),a(h,{open:_.value,"onUpdate:open":e[7]||(e[7]=o=>_.value=o),"ok-text":"确定","cancel-text":"取消",onOk:V,onCancel:q,title:"编辑"},{default:s(()=>[a(w,{ref_key:"formRef",ref:c,model:l.value,labelCol:{span:6},wrapperCol:{span:14}},{default:s(()=>[a(m,{name:"userAccount",label:"工资号",rules:[{required:!0,message:"请输入工资号"}]},{default:s(()=>[a(u,{value:l.value.userAccount,"onUpdate:value":e[4]||(e[4]=o=>l.value.userAccount=o),placeholder:"请输入工资号"},null,8,["value"])]),_:1}),a(m,{name:"userName",label:"姓名",rules:[{required:!0,message:"请输入姓名"}]},{default:s(()=>[a(u,{value:l.value.userName,"onUpdate:value":e[5]||(e[5]=o=>l.value.userName=o),placeholder:"请输入姓名"},null,8,["value"])]),_:1}),a(m,{label:"权限"},{default:s(()=>[a(z,{value:l.value.roleId,"onUpdate:value":e[6]||(e[6]=o=>l.value.roleId=o)},{default:s(()=>[a(x,{value:1},{default:s(()=>[S("管理员")]),_:1}),a(x,{value:0},{default:s(()=>[S("教师")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),C(a(J,{columns:R,"data-source":v.value,"row-key":"itemId",bordered:""},{bodyCell:s(({column:o,record:I})=>[o.dataIndex==="operation"?(b(),k("span",X,[A("a",{onClick:ae=>B(I)},"编辑",8,Y),a(Q,{onDelete:D,tagetId:I.userId},null,8,["tagetId"])])):T("",!0)]),_:1},8,["data-source"]),[[N,n.value]])],64)}}},se=j(Z,[["__scopeId","data-v-dc2998c5"]]);export{se as default};
