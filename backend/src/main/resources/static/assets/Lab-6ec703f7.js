import{_ as X,g as i,o as Y,h as r,b as p,c as h,i as l,j as n,w as N,k as w,d as x,F as C,m as _,l as D,q as E,z as Z,r as ee,x as F,s as O,t as R}from"./index-e6beac7b.js";import{g as ae}from"./Instance-3897144e.js";import{O as te,d as le,D as oe}from"./exportToExcel-4ab05172.js";import{e as ne}from"./utils-cffd9ece.js";const se={class:"loading"},ue={key:0},de=["onClick"],re=["onClick"],ce={__name:"Lab",setup(ie){const u=ae();let A,v;const o=i({}),L=i(!1),b=i(!1),y=t=>{o.value.userAccount=t},V=async()=>{o.value={},v===void 0&&(v=(await u.getAllUserList()).data.data),b.value=!0},q=t=>{s.value=!1,u.getLabList(t).then(e=>{c.value=e.data.data,s.value=!0})},$=t=>{ee.push({name:"labDetail",query:{id:ne(t)}})},m=i(),z=()=>{m.value.validateFields().then(t=>{s.value=!1,u.addLab(o.value).then(e=>{e.data.code===1?(_.info(e.data.data),u.getLabList().then(d=>{c.value=d.data.data,s.value=!0})):(_.info(e.data.msg),s.value=!0)}),b.value=!1}).catch(t=>{console.log("Validate Failed:",t)})},J=()=>{m.value.resetFields(),b.value=!1},g=i(!1),j=async t=>{o.value=JSON.parse(JSON.stringify(t)),v===void 0&&(v=(await u.getAllUserList()).data.data),g.value=!0},M=()=>{m.value.validateFields().then(t=>{s.value=!1,u.editLab(o.value).then(e=>{e.data.code===1?(_.info(e.data.data),u.getLabList().then(d=>{c.value=d.data.data,s.value=!0})):(_.info(e.data.msg),s.value=!0)}),g.value=!1}).catch(t=>{console.log("Validate Failed:",t)})},T=()=>{m.value.resetFields(),g.value=!1},G=t=>{s.value=!1,u.deleteLabById(t).then(e=>{e.data.code===1?(_.info(e.data.data),u.getLabList().then(d=>{c.value=d.data.data,s.value=!0})):_.info(e.data.msg)})};Y(()=>{u.whoami().then(t=>{t.data.code===1&&(A=t.data.data,L.value=A.roleId)}),u.getLabList().then(t=>{c.value=t.data.data,s.value=!0})});const H=()=>{le("/lab",c.value,"实验室表.xlsx")},c=i(),s=i(!1),K=[{title:"实验室名称",dataIndex:"labName",width:"15%"},{title:"管理员名称",dataIndex:"userName",width:"15%"},{title:"管理员工资号",dataIndex:"userAccount",width:"40%"},{title:"操作",dataIndex:"operation"}];return(t,e)=>{const d=r("a-input"),f=r("a-form-item"),I=r("a-select-option"),S=r("a-select"),U=r("a-form"),B=r("a-modal"),P=r("a-spin"),Q=r("a-table");return p(),h(C,null,[l(B,{open:b.value,"onUpdate:open":e[3]||(e[3]=a=>b.value=a),"ok-text":"确定","cancel-text":"取消",onOk:z,onCancel:J,title:"添加"},{default:n(()=>[l(U,{ref_key:"formRef",ref:m,model:o.value,labelCol:{span:6},wrapperCol:{span:14}},{default:n(()=>[l(f,{name:"labName",label:"地点",rules:[{required:!0,message:"请输入地点"}]},{default:n(()=>[l(d,{value:o.value.labName,"onUpdate:value":e[0]||(e[0]=a=>o.value.labName=a),placeholder:"请输入地点"},null,8,["value"])]),_:1}),l(f,{name:"userName",label:"管理人",rules:[{required:!0,message:"请选择管理人"}]},{default:n(()=>[l(S,{value:o.value.userName,"onUpdate:value":e[1]||(e[1]=a=>o.value.userName=a),placeholder:"请选择"},{default:n(()=>[(p(!0),h(C,null,D(E(v),a=>(p(),F(I,{value:a.userName,onClick:k=>y(a.userAccount)},{default:n(()=>[O(R(a.userName),1)]),_:2},1032,["value","onClick"]))),256))]),_:1},8,["value"])]),_:1}),l(f,{label:"工资号"},{default:n(()=>[l(d,{value:o.value.userAccount,"onUpdate:value":e[2]||(e[2]=a=>o.value.userAccount=a),disabled:!0},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),l(te,{addShow:L.value,onAdd:V,onExport:H,onSearch:q},null,8,["addShow"]),N(x("div",se,[l(P,{size:"large"})],512),[[w,!s.value]]),l(B,{open:g.value,"onUpdate:open":e[7]||(e[7]=a=>g.value=a),"ok-text":"确定","cancel-text":"取消",onOk:M,onCancel:T,title:"编辑"},{default:n(()=>[l(U,{ref_key:"formRef",ref:m,model:o.value,labelCol:{span:6},wrapperCol:{span:14}},{default:n(()=>[l(f,{label:"地点"},{default:n(()=>[l(d,{value:o.value.labName,"onUpdate:value":e[4]||(e[4]=a=>o.value.labName=a),disabled:!0},null,8,["value"])]),_:1}),l(f,{label:"管理人"},{default:n(()=>[l(S,{value:o.value.userName,"onUpdate:value":e[5]||(e[5]=a=>o.value.userName=a),placeholder:"请选择"},{default:n(()=>[(p(!0),h(C,null,D(E(v),a=>(p(),F(I,{value:a.userName,onClick:k=>y(a.userAccount)},{default:n(()=>[O(R(a.userName),1)]),_:2},1032,["value","onClick"]))),256))]),_:1},8,["value"])]),_:1}),l(f,{label:"工资号"},{default:n(()=>[l(d,{value:o.value.userAccount,"onUpdate:value":e[6]||(e[6]=a=>o.value.userAccount=a),disabled:!0},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),N(l(Q,{columns:K,"data-source":c.value,"row-key":"itemId",bordered:""},{bodyCell:n(({column:a,record:k})=>[a.dataIndex==="operation"?(p(),h("span",ue,[x("a",{onClick:W=>j(k)},"编辑",8,de),x("a",{class:"check-button",onClick:W=>$(k.labName)},"查看",8,re),N(l(oe,{onDelete:G,tagetId:k.labId},null,8,["tagetId"]),[[w,L.value]])])):Z("",!0)]),_:1},8,["data-source"]),[[w,s.value]])],64)}}},_e=X(ce,[["__scopeId","data-v-bc242c73"]]);export{_e as default};
